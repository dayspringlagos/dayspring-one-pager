<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dayspring Lagos Blog | Believers Way of Salvation Ministry</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .blog-card { transition: transform 0.3s, box-shadow 0.3s; }
    .blog-card:hover { transform: translateY(-4px); box-shadow: 0 10px 30px rgba(250, 204, 21, 0.1); }
  </style>
  <link rel="icon" href="dayspring-logo.png" sizes="32x32" />
  <link rel="apple-touch-icon" href="dayspring-logo.png" />
</head>
<body class="bg-neutral-950 text-neutral-100">

  <!-- NAVBAR -->
  <header class="fixed top-0 left-0 w-full z-50 bg-neutral-950/80 backdrop-blur border-b border-neutral-800">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center gap-3">
        <img src="dayspring-logo.png" alt="Dayspring logo" class="w-9 h-9 rounded-full object-cover" />
        <h1 class="font-bold text-lg tracking-wide">Dayspring Lagos</h1>
      </div>
      <nav class="hidden md:flex gap-6 text-sm">
        <a href="web.html" class="hover:text-yellow-400">Home</a>
        <a href="#posts" class="hover:text-yellow-400">Blog</a>
        <a href="#featured" class="hover:text-yellow-400">Featured</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="pt-32 pb-16 px-6 bg-gradient-to-b from-neutral-900 to-neutral-950">
    <div class="max-w-5xl mx-auto text-center">
      <h2 class="text-4xl md:text-5xl font-bold mb-6">Dayspring Blog</h2>
      <p class="text-neutral-300 max-w-3xl mx-auto mb-8">
        Insights, teachings, and stories from the Dayspring Lagos community. Grow in faith and knowledge.
      </p>
    </div>
  </section>

  <!-- FEATURED POST -->
  <section id="featured" class="py-16 px-6 bg-neutral-900">
    <div class="max-w-5xl mx-auto">
      <h3 class="text-2xl font-semibold mb-8">Featured</h3>
      <div id="featuredPost" class="bg-neutral-800 rounded-2xl border border-neutral-700 overflow-hidden">
        <div class="h-64 bg-neutral-700 flex items-center justify-center">
          <img id="featuredImage" src="" alt="Featured post" class="w-full h-full object-cover" />
        </div>
        <div class="p-8">
          <h4 id="featuredTitle" class="text-3xl font-bold mb-4">Loading...</h4>
          <p id="featuredExcerpt" class="text-neutral-300 mb-6 line-clamp-3">Featured post excerpt will appear here</p>
          <div class="flex items-center justify-between">
            <span id="featuredDate" class="text-neutral-400 text-sm">Date</span>
            <a id="featuredLink" href="#" class="bg-yellow-400 text-neutral-900 px-6 py-2 rounded-lg font-semibold hover:bg-yellow-300">Read Full Story</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- SEARCH & FILTER -->
  <section class="py-12 px-6">
    <div class="max-w-5xl mx-auto">
      <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
        <input 
          type="text" 
          id="searchInput" 
          placeholder="Search blog posts..." 
          class="flex-1 bg-neutral-900 border border-neutral-800 rounded-lg px-4 py-2 text-neutral-100 placeholder-neutral-500 focus:outline-none focus:border-yellow-400"
        />
        <select 
          id="categoryFilter" 
          class="bg-neutral-900 border border-neutral-800 rounded-lg px-4 py-2 text-neutral-100 focus:outline-none focus:border-yellow-400"
        >
          <option value="">All Categories</option>
          <option value="teaching">Teaching</option>
          <option value="devotional">Devotional</option>
          <option value="news">News</option>
          <option value="testimony">Testimony</option>
        </select>
      </div>
    </div>
  </section>

  <!-- BLOG POSTS GRID -->
  <section id="posts" class="py-16 px-6">
    <div class="max-w-6xl mx-auto">
      <h3 class="text-2xl font-semibold mb-12">All Posts</h3>
      <div id="blogGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="bg-neutral-900 rounded-2xl border border-neutral-800 overflow-hidden blog-card animate-pulse">
          <div class="h-40 bg-neutral-800"></div>
          <div class="p-6">
            <div class="h-4 bg-neutral-700 rounded mb-3"></div>
            <div class="h-6 bg-neutral-700 rounded mb-3"></div>
            <div class="h-3 bg-neutral-700 rounded mb-3"></div>
          </div>
        </div>
      </div>
      <div id="noResults" class="text-center py-12 hidden">
        <p class="text-neutral-400">No posts found. Check back soon!</p>
      </div>
    </div>
  </section>

  <!-- PAGINATION -->
  <section class="py-12 px-6">
    <div class="max-w-6xl mx-auto flex justify-center gap-2">
      <button id="prevBtn" class="bg-neutral-900 border border-neutral-800 px-4 py-2 rounded hover:bg-neutral-800">Previous</button>
      <div id="pageInfo" class="bg-neutral-900 border border-neutral-800 px-4 py-2 rounded text-neutral-400">Page 1</div>
      <button id="nextBtn" class="bg-neutral-900 border border-neutral-800 px-4 py-2 rounded hover:bg-neutral-800">Next</button>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="py-10 px-6 border-t border-neutral-800 text-center text-neutral-500 text-sm">
    <div class="max-w-4xl mx-auto">
      <div class="text-xs mb-6">© 2026 Dayspring Lagos — Believers Way of Salvation Ministry</div>
      <div class="flex items-center justify-center gap-4 flex-wrap">
        <a href="https://www.tiktok.com/@dayspringlagosng" target="_blank" class="hover:opacity-80 font-semibold text-xs" style="color: #FFFFFF;">TikTok</a>
        <a href="https://www.youtube.com/@dayspringlagosng" target="_blank" class="hover:opacity-80 font-semibold text-xs" style="color: #FF0000;">YouTube</a>
        <a href="https://www.facebook.com/dayspringlagosng" target="_blank" class="hover:opacity-80 font-semibold text-xs" style="color: #1877F2;">Facebook</a>
        <a href="https://www.instagram.com/dayspringlagosng" target="_blank" class="hover:opacity-80 font-semibold text-xs" style="color: #E1306C;">Instagram</a>
        <a href="mailto:dayspringlagos@gmail.com" class="hover:opacity-80 font-semibold text-xs" style="color: #EA4335;">Gmail</a>
        <a href="https://wa.me/2349134301458" target="_blank" class="hover:opacity-80 font-semibold text-xs" style="color: #25D366;">WhatsApp</a>
      </div>
    </div>
  </footer>

  <!-- SINGLE POST MODAL -->
  <div id="postModal" class="hidden fixed inset-0 bg-black/60 backdrop-blur flex items-center justify-center z-50 p-4">
    <div class="bg-neutral-950 rounded-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto border border-neutral-800">
      <div class="sticky top-0 flex justify-between items-center p-6 border-b border-neutral-800 bg-neutral-950">
        <h2 id="modalTitle" class="text-2xl font-bold"></h2>
        <button id="closeModal" class="text-neutral-400 hover:text-white text-2xl">&times;</button>
      </div>
      <div class="p-6">
        <img id="modalImage" src="" alt="" class="w-full h-64 object-cover rounded-lg mb-6" />
        <div class="flex gap-4 mb-6 text-sm text-neutral-400">
          <span id="modalDate"></span>
          <span id="modalAuthor"></span>
          <span id="modalCategory" class="bg-neutral-800 px-3 py-1 rounded"></span>
        </div>
        <div id="modalContent" class="prose prose-invert max-w-none text-neutral-300 leading-relaxed"></div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = 'http://localhost:3001/api'; // Local development - change for production
    let currentPage = 1;
    const postsPerPage = 9;
    let allPosts = [];
    let filteredPosts = [];

    // Fetch all blog posts from database
    async function fetchPosts() {
      try {
        const response = await fetch(`${API_BASE}/posts?limit=100`);
        const data = await response.json();
        allPosts = data.posts || [];
        filteredPosts = allPosts;
        displayPosts();
        displayFeaturedPost();
      } catch (error) {
        console.error('Error fetching posts from database:', error);
        document.getElementById('blogGrid').innerHTML = '<p class="text-neutral-400">Failed to load posts. Make sure the API server is running.</p>';
      }
    }

    // Display posts with pagination
    function displayPosts() {
      const start = (currentPage - 1) * postsPerPage;
      const end = start + postsPerPage;
      const paginatedPosts = filteredPosts.slice(start, end);

      if (paginatedPosts.length === 0) {
        document.getElementById('blogGrid').innerHTML = '';
        document.getElementById('noResults').classList.remove('hidden');
        return;
      }

      document.getElementById('noResults').classList.add('hidden');
      document.getElementById('blogGrid').innerHTML = paginatedPosts.map(post => {
        const categoryName = post.category_name || 'Blog';
        return `
        <div class="bg-neutral-900 rounded-2xl border border-neutral-800 overflow-hidden blog-card cursor-pointer hover:border-yellow-400" onclick="openPost('${post.id}')">
          <img src="${post.image || 'https://via.placeholder.com/400x200'}" alt="${post.title}" class="w-full h-40 object-cover" />
          <div class="p-6">
            <span class="text-xs bg-neutral-800 text-yellow-400 px-3 py-1 rounded">${categoryName}</span>
            <h4 class="text-lg font-bold mt-3 mb-2 line-clamp-2">${post.title}</h4>
            <p class="text-neutral-400 text-sm mb-4 line-clamp-2">${post.excerpt}</p>
            <div class="flex justify-between items-center text-xs text-neutral-500">
              <span>${new Date(post.created_at).toLocaleDateString()}</span>
              <span>${post.author || 'Dayspring'}</span>
            </div>
          </div>
        </div>
      `}).join('');

      updatePaginationButtons();
    }

    // Display featured post
    function displayFeaturedPost() {
      const featured = allPosts[0];
      if (featured) {
        document.getElementById('featuredTitle').textContent = featured.title;
        document.getElementById('featuredExcerpt').textContent = featured.excerpt;
        document.getElementById('featuredImage').src = featured.image || 'https://via.placeholder.com/800x400';
        document.getElementById('featuredDate').textContent = new Date(featured.created_at).toLocaleDateString();
        document.getElementById('featuredLink').onclick = () => openPost(featured.id);
      }
    }

    // Open single post modal
    function openPost(postId) {
      const post = allPosts.find(p => p.id === postId);
      if (post) {
        document.getElementById('modalTitle').textContent = post.title;
        document.getElementById('modalImage').src = post.image || 'https://via.placeholder.com/800x400';
        document.getElementById('modalDate').textContent = new Date(post.created_at).toLocaleDateString();
        document.getElementById('modalAuthor').textContent = `By ${post.author || 'Dayspring'}`;
        document.getElementById('modalCategory').textContent = post.category_name || 'Blog';
        document.getElementById('modalContent').innerHTML = post.content;
        document.getElementById('postModal').classList.remove('hidden');
      }
    }

    // Close modal
    document.getElementById('closeModal').addEventListener('click', () => {
      document.getElementById('postModal').classList.add('hidden');
    });

    document.getElementById('postModal').addEventListener('click', (e) => {
      if (e.target.id === 'postModal') {
        document.getElementById('postModal').classList.add('hidden');
      }
    });

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', (e) => {
      const search = e.target.value.toLowerCase();
      filteredPosts = allPosts.filter(post => 
        post.title.toLowerCase().includes(search) || 
        post.excerpt.toLowerCase().includes(search) ||
        post.content.toLowerCase().includes(search)
      );
      currentPage = 1;
      displayPosts();
    });

    // Category filter
    document.getElementById('categoryFilter').addEventListener('change', (e) => {
      const category = e.target.value;
      filteredPosts = category ? allPosts.filter(p => p.category === category) : allPosts;
      currentPage = 1;
      displayPosts();
    });

    // Pagination
    function updatePaginationButtons() {
      const maxPage = Math.ceil(filteredPosts.length / postsPerPage);
      document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${maxPage}`;
      document.getElementById('prevBtn').disabled = currentPage === 1;
      document.getElementById('nextBtn').disabled = currentPage === maxPage;
    }

    document.getElementById('prevBtn').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        displayPosts();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
      const maxPage = Math.ceil(filteredPosts.length / postsPerPage);
      if (currentPage < maxPage) {
        currentPage++;
        displayPosts();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
    });

    // Load posts on page load
    fetchPosts();
  </script>

</body>
</html>
